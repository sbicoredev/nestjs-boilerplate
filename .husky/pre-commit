#!/bin/sh

# get the current branch name
BRANCH_NAME=$(git rev-parse --abbrev-ref HEAD)

# Define the regular expression for branch name validation
# Example regex requires branch to start with 'feature/...'
BRANCH_REGEX="^(feature|hotfix|bugfix|refactor|test|chore|docs)\/[a-zA-Z]+([-a-zA-Z0-9]*[a-zA-Z0-9])?$"

GREEN='\033[0;32m'
RED='\033[0;31m'
NC='\033[0m'

if ! echo "$BRANCH_NAME" | grep -qE "$BRANCH_REGEX"; then
  echo "${RED}ERROR: Branch name '$BRANCH_NAME' does not match naming convention$NC"
  echo ""
  echo "Expected format: <type>/<description>"
  echo "Types: feature, hotfix, bugfix, refactor, test, chore, docs"
	echo "Description: start with a letter, can include letters, numbers, and hyphens"
  echo ""
  echo "Examples:$GREEN"
  echo "  feature/user-authentication"
  echo "  hotfix/urgent-patch-crash"
	echo "  bugfix/fix-login-error"
  echo "  refactor/remove-unused-code"
  echo "  test/add-unit-tests"
  echo "  chore/update-docker-compose"
  echo "  docs/add-api-instructions$NC"
  echo ""
  exit 1
fi

bun lint-staged
